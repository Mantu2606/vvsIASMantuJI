@using FossTech.Models
@model FossTech.Areas.Dashboard.ViewModels.UserHeaderViewModel

<nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
    @* <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
    <i class="fa fa-bars"></i>
    </button>
    *@
    <div style="display: flex; flex-direction: column; align-items: flex-start; background-color: #03568200; padding: 4px 10px; border-radius: 8px; color: Black; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
        <div>
            <h5 style="margin: 0;">
                <strong>Welcome,</strong> <span style="color:#233d81">@Model.UserName</span>
            </h5>
            <small></small>
            <div style="display: flex; flex-direction: column; align-items: flex-start; color: #b0b0b0; font-size: 10px; margin-top: 4px;">
                <div id="date-time">
                    <span id="updateTime"></span>
                </div>
               @*  <div id="sessionTime">
                    login time: <span id="totalLoginTime">0 hours 0 minutes</span>
                </div> *@
            </div>
        </div>
    </div>

    <ul class="navbar-nav ml-auto">
        <li class="nav-item dropdown no-arrow d-flex align-items-center">
            <img src="@Model.ProfilePhoto" alt="Profile Photo" class="img-profile rounded-circle" id="userDropdownToggle" style="cursor: pointer; max-height: 60px;max-width:60px" />

            <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in" aria-labelledby="userDropdown" id="userDropdownMenu">
                <a class="dropdown-item" asp-area="Dashboard" asp-controller="Profile" asp-action="Index">
                    <img src="@Model.ProfilePhoto" width="20px" class="rounded" style="margin:0 2px"/>
                    My Profile
                </a>
                <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                    <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-danger"></i>
                    <span class="text-danger">Logout</span>
                </a>
            </div>
        </li>
    </ul>

    <!-- JavaScript/jQuery to toggle dropdown on image click -->
   
  




</nav>

<style>
    .switch input {
        display: none;
    }

    .switch {
        display: inline-block;
        width: 60px;
        height: 30px;
        margin: 8px;
        transform: translateY(50%);
        position: relative;
        top: -15px;
    }

    .slider {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        border-radius: 30px;
        box-shadow: 0 0 0 2px #777, 0 0 4px #777;
        cursor: pointer;
        border: 4px solid transparent;
        overflow: hidden;
        transition: .4s;
    }

        .slider:before {
            position: absolute;
            content: "";
            width: 100%;
            height: 100%;
            background: #777;
            border-radius: 30px;
            transform: translateX(-30px);
            transition: .4s;
        }

    input:checked + .slider:before {
        transform: translateX(30px);
        background: limeGreen;
    }

    input:checked + .slider {
        box-shadow: 0 0 0 2px limeGreen,0 0 2px limeGreen;
    }

    .switch.flat .slider {
        box-shadow: none;
    }

        .switch.flat .slider:before {
            background: #FFF;
        }

    .switch.flat input:checked + .slider:before {
        background: white;
    }

    .switch.flat input:checked + .slider {
        background: limeGreen;
    }
</style>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>

<script>
    let sessionStartTime = localStorage.getItem('sessionStartTime');
    if (!sessionStartTime) {
        sessionStartTime = new Date().getTime();
        localStorage.setItem('sessionStartTime', sessionStartTime);
    }

    function updateDateTime() {
        const now = new Date();
        const day = now.toLocaleString('en-us', { weekday: 'short' });
        const time = now.toLocaleTimeString();
        document.getElementById('updateTime').innerHTML = `${day} ${time}`;

        // const elapsedTime = now.getTime() - sessionStartTime;
        // const hours = Math.floor(elapsedTime / (1000 * 60 * 60));
        // const minutes = Math.floor((elapsedTime % (1000 * 60 * 60)) / (1000 * 60));
        // document.getElementById('totalLoginTime').innerText = `${hours} hours ${minutes} minutes`;
    }

    setInterval(updateDateTime, 1000);
    updateDateTime();
</script>
<script>
    $(document).ready(function () {
        $('#userDropdownToggle').click(function (e) {
            e.stopPropagation();  
            $('#userDropdownMenu').toggle(); 
        });

        $(document).click(function (e) {
            if (!$(e.target).closest('#userDropdownToggle').length && !$(e.target).closest('#userDropdownMenu').length) {
                $('#userDropdownMenu').hide(); 
            }
        });
    });
</script>
